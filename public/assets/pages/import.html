<div class="section-card">
    <div class="section-header">
        <h3>导入线索数据</h3>
    </div>
    <form id="import-form" class="task-form" enctype="multipart/form-data">
        <div class="form-group">
            <label>任务名称（可选）</label>
            <input type="text" name="taskName" placeholder="例如：Manus导入-2026年1月">
        </div>
        <div class="form-group">
            <label>数据来源分类</label>
            <select name="source" id="source-select">
                <option value="import" selected>import (默认)</option>
                <option value="manus">manus</option>
                <option value="存量数据迁移">存量数据迁移</option>
            </select>
            <input type="text" name="customSource" id="custom-source-input" placeholder="输入自定义分类名称"
                style="display: none; margin-top: 8px;">
        </div>
        <div class="form-group">
            <label>Excel 文件</label>
            <div class="file-upload-area" id="file-upload-area">
                <input type="file" name="file" id="file-input" accept=".xlsx,.xls,.csv" required>
                <div class="file-upload-placeholder">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <p>点击选择文件或拖拽到此处</p>
                    <span class="file-types">支持 .xlsx, .xls, .csv 格式</span>
                </div>
                <div class="file-selected" id="file-selected" style="display: none;">
                    <span class="file-name" id="file-name"></span>
                    <button type="button" class="btn-text" id="clear-file-btn">清除</button>
                </div>
            </div>
            <small class="form-hint">Excel 表头应包含：公司名称（必填）、网站、联系人、邮箱、电话、地区 等</small>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn-primary" id="submit-btn">开始导入</button>
            <a href="/assets/templates/import_template.xlsx" class="btn-secondary" download>下载模板</a>
        </div>
    </form>
</div>

<div class="section-card">
    <div class="section-header">
        <h3>导入历史</h3>
        <button class="btn-secondary btn-sm" id="refresh-tasks-btn">刷新</button>
    </div>
    <div id="import-tasks-container">
        <div class="loading">加载中...</div>
    </div>
</div>

<div class="section-card">
    <div class="section-header">
        <h3>已导入线索</h3>
        <div class="header-actions">
            <button class="btn-secondary btn-sm" id="refresh-leads-btn">刷新</button>
            <button class="btn-primary btn-sm" id="sync-selected-btn" disabled>同步选中到CRM</button>
        </div>
    </div>
    <div class="table-container">
        <table class="data-table" id="import-leads-table">
            <thead>
                <tr>
                    <th><input type="checkbox" id="select-all-leads"></th>
                    <th>公司名称</th>
                    <th>网站</th>
                    <th>联系人</th>
                    <th>邮箱</th>
                    <th>CRM状态</th>
                    <th>导入时间</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody id="import-leads-body">
                <tr>
                    <td colspan="8" class="empty-state">暂无导入数据</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="pagination" id="leads-pagination"></div>
</div>

<style>
    .file-upload-area {
        border: 2px dashed rgba(102, 126, 234, 0.4);
        border-radius: 12px;
        padding: 32px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background: rgba(102, 126, 234, 0.05);
        position: relative;
    }

    .file-upload-area:hover {
        border-color: rgba(102, 126, 234, 0.8);
        background: rgba(102, 126, 234, 0.1);
    }

    .file-upload-area.dragover {
        border-color: #667eea;
        background: rgba(102, 126, 234, 0.15);
    }

    .file-upload-area input[type="file"] {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }

    .file-upload-placeholder {
        color: #94a3b8;
    }

    .file-upload-placeholder svg {
        margin-bottom: 12px;
        opacity: 0.6;
    }

    .file-upload-placeholder p {
        margin: 0 0 8px 0;
        font-size: 15px;
    }

    .file-types {
        font-size: 13px;
        opacity: 0.7;
    }

    .file-selected {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
    }

    .file-name {
        color: #667eea;
        font-weight: 500;
    }

    .btn-text {
        background: none;
        border: none;
        color: #ef4444;
        cursor: pointer;
        font-size: 13px;
    }

    .btn-text:hover {
        text-decoration: underline;
    }

    .form-actions {
        display: flex;
        gap: 12px;
        margin-top: 16px;
    }
</style>